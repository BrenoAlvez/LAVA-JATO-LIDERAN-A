<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>ðŸš— Agendamento Lava-Jato LideranÃ§a</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="LideranÃ§a Agend.">
    
    <meta name="theme-color" content="#1a75ff"> 
    
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='images/logo_lideranca.png') }}">
</head>
<body>
    <div class="container">
        <header>
            <img src="{{ url_for('static', filename='images/logo_lideranca.png') }}" 
                 alt="Logo do Lava Jato LideranÃ§a" 
                 style="max-width: 150px; height: auto; margin-bottom: 10px;">
            
            <h1 style="color: var(--primary-color); border-bottom: none; padding-bottom: 0;">
                LAVA JATO LIDERANÃ‡A
            </h1>
            <p style="font-size: 0.9em; color: #6c757d; margin-top: -10px;">
                ðŸ§¼ **Qualidade e ConfianÃ§a:** Agende seu serviÃ§o com garantia de excelÃªncia!
            </p>
        </header>
        
        <div id="boas_vindas" class="mensagem-confianca">
            ðŸ‘‹ <strong>Seja bem-vindo(a) ao Lava-Jato LideranÃ§a!</strong> Ã‰ um prazer recebÃª-lo. Estamos Ã  sua disposiÃ§Ã£o para cuidar do seu veÃ­culo com o mÃ¡ximo de atenÃ§Ã£o e qualidade.
        </div>
        
        <div id="painel_preco" style="
            display: none; 
            padding: 15px; 
            margin-bottom: 20px; 
            border: 2px solid var(--primary-color); 
            border-radius: 6px; 
            background-color: #e9f0ff; 
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: var(--primary-color);">
            VALOR ESTIMADO: <span id="valor_exibido"></span>
        </div>

        <h2 class="form-title">
            Novo Agendamento
        </h2>

        <form method="POST" action="{{ url_for('index') }}">
            <div>
                <label for="cliente">Nome do Cliente:</label>
                <input type="text" id="cliente" name="cliente" required onkeyup="atualizarBoasVindas()">
            </div>
            <div>
                <label for="placa">Placa do VeÃ­culo:</label>
                <input type="text" id="placa" name="placa" required>
            </div>

            <div>
                <label for="tipo_veiculo">Tipo de VeÃ­culo:</label>
                <select id="tipo_veiculo" name="tipo_veiculo" required onchange="atualizarServicos()">
                    <option value="" disabled selected>Selecione</option>
                    <option value="Carro">Carro</option>
                    <option value="Moto">Moto</option>
                </select>
            </div>
            
            <div>
                <label for="servico">ServiÃ§o Desejado:</label>
                <select id="servico" name="servico" required>
                    <option value="" disabled selected>Escolha o tipo de veÃ­culo primeiro</option>
                </select>
            </div>

            <div>
                <label for="data_hora_input">Data e Hora:</label>
                <input type="datetime-local" id="data_hora_input" name="data_hora_input" required>
            </div>
            
            <button type="submit">ðŸ”’ Agendar e Confirmar via WhatsApp</button>
        </form>

        <h2>ðŸ“… PrÃ³ximos Agendamentos</h2>
        {% if agendamentos %}
        <table>
            <thead>
                <tr>
                    <th>Data/Hora</th>
                    <th>Cliente</th>
                    <th>Placa</th>
                    <th>ServiÃ§o</th>
                </tr>
            </thead>
            <tbody>
                {% for agendamento in agendamentos %}
                <tr>
                    <td>{{ agendamento.data_hora_str }}</td>
                    <td>{{ agendamento.cliente }}</td>
                    <td>{{ agendamento.placa }}</td>
                    <td>{{ agendamento.servico }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p>NÃ£o hÃ¡ agendamentos cadastrados.</p>
        {% endif %}
    </div>

    <script>
        // DefiniÃ§Ã£o das opÃ§Ãµes de serviÃ§o por tipo de veÃ­culo
        const servicosPorVeiculo = {
            Carro: [
                { valor: "Simples", texto: "Lavagem Simples" }, 
                { valor: "Completa", texto: "Lavagem Completa" }, 
                { valor: "Completa Sem Cera", texto: "Lavagem Completa (Sem Cera)" }, 
                { valor: "Completa + Motor", texto: "Lavagem Completa + Motor" }, 
                { valor: "Motor", texto: "Lavagem Apenas do Motor" } 
            ],
            Moto: [
                { valor: "Completa Moto", texto: "Lavagem Completa Moto" } 
            ]
        };

        // Tabela de PreÃ§os
        const tabelaPrecos = {
            "Simples": 50.00,
            "Completa": 80.00,
            "Completa Sem Cera": 70.00,
            "Completa + Motor": 120.00,
            "Motor": 50.00,
            "Completa Moto": 30.00
        };

        // FunÃ§Ã£o de Boas-Vindas Atualizada
        function atualizarBoasVindas() {
            const clienteInput = document.getElementById('cliente');
            const boasVindasDiv = document.getElementById('boas_vindas');
            const nome = clienteInput.value.trim();
            
            const textoBase = `Ã‰ um prazer recebÃª-lo. Estamos Ã  sua disposiÃ§Ã£o para cuidar do seu veÃ­culo com o mÃ¡ximo de atenÃ§Ã£o e qualidade.`;
            
            if (nome.length > 0) {
                const nomeFormatado = nome.charAt(0).toUpperCase() + nome.slice(1).toLowerCase();
                // Adiciona o negrito ao nome personalizado
                boasVindasDiv.innerHTML = `ðŸ‘‹ <strong>OlÃ¡, ${nomeFormatado}!</strong> ${textoBase}`;
                
            } else {
                // Mensagem padrÃ£o em negrito
                boasVindasDiv.innerHTML = `ðŸ‘‹ <strong>Seja bem-vindo(a) ao Lava-Jato LideranÃ§a!</strong> ${textoBase}`;
            }
        }
        
        function atualizarServicos() {
            const tipoVeiculoSelect = document.getElementById('tipo_veiculo');
            const servicoSelect = document.getElementById('servico');
            const tipoSelecionado = tipoVeiculoSelect.value;

            servicoSelect.innerHTML = '<option value="" disabled selected>Selecione um serviÃ§o</option>';
            esconderPreco(); 

            if (tipoSelecionado && servicosPorVeiculo[tipoSelecionado]) {
                const opcoes = servicosPorVeiculo[tipoSelecionado];
                
                opcoes.forEach(servico => {
                    const novaOpcao = document.createElement('option');
                    novaOpcao.value = servico.valor;
                    novaOpcao.textContent = servico.texto;
                    servicoSelect.appendChild(novaOpcao);
                });
            }
        }
        
        function exibirPreco() {
            const servicoSelect = document.getElementById('servico');
            const painel = document.getElementById('painel_preco');
            const valorExibido = document.getElementById('valor_exibido');
            const servicoSelecionado = servicoSelect.value;
            
            if (servicoSelecionado && tabelaPrecos[servicoSelecionado]) {
                const preco = tabelaPrecos[servicoSelecionado];
                valorExibido.textContent = 'R$ ' + preco.toFixed(2).replace('.', ',');
                painel.style.display = 'block';
            } else {
                esconderPreco();
            }
        }

        function esconderPreco() {
            document.getElementById('painel_preco').style.display = 'none';
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', () => {
            atualizarServicos();
            atualizarBoasVindas(); 
            
            document.getElementById('servico').addEventListener('change', exibirPreco); 
            
            document.getElementById('tipo_veiculo').addEventListener('change', () => {
                atualizarServicos();
                esconderPreco(); 
            });
        });
    </script>
</body>
</html>